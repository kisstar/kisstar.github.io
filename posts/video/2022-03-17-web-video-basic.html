<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Web 视频基础理论 | Kisstar's 博客</title>
    <meta name="description" content="Kisstar's 的个人博客站点。">
    <link rel="preload stylesheet" href="/assets/style.5086de7b.css" as="style">
    
    <script type="module" src="/assets/app.c1c2825d.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.eecc699f.js">
    <link rel="modulepreload" href="/assets/chunks/theme.213b108a.js">
    <link rel="modulepreload" href="/assets/posts_video_2022-03-17-web-video-basic.md.83639c4f.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-eff2d9f0><!--[--><!--]--><!--[--><span tabindex="-1" data-v-9641289a></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-9641289a> Skip to content </a><!--]--><!----><header class="VPNav" data-v-eff2d9f0 data-v-2e0fbc41><div class="VPNavBar" data-v-2e0fbc41 data-v-5b3ad17e><div class="container" data-v-5b3ad17e><div class="title" data-v-5b3ad17e><div class="VPNavBarTitle" data-v-5b3ad17e data-v-dbaa6e97><a class="title" href="/" data-v-dbaa6e97><!--[--><!--]--><!----><!--[-->Kisstar&#39;s 博客<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-5b3ad17e><div class="curtain" data-v-5b3ad17e></div><div class="content-body" data-v-5b3ad17e><!--[--><!--]--><div class="VPNavBarSearch search" data-v-5b3ad17e><!----></div><!----><!----><div class="VPNavBarAppearance appearance" data-v-5b3ad17e data-v-2397613a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-2397613a data-v-48a070cb data-v-daf23560><span class="check" data-v-daf23560><span class="icon" data-v-daf23560><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-48a070cb><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-48a070cb><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-5b3ad17e data-v-c737ce0e data-v-1bf78fa1><!--[--><a class="VPSocialLink no-icon" href="https://github.com/kisstar" aria-label="github" target="_blank" rel="noopener" data-v-1bf78fa1 data-v-6efba382><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-5b3ad17e data-v-71724fcd data-v-72298b7f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-72298b7f><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-72298b7f><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-72298b7f><div class="VPMenu" data-v-72298b7f data-v-d0374188><!----><!--[--><!--[--><!----><div class="group" data-v-71724fcd><div class="item appearance" data-v-71724fcd><p class="label" data-v-71724fcd>Appearance</p><div class="appearance-action" data-v-71724fcd><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-71724fcd data-v-48a070cb data-v-daf23560><span class="check" data-v-daf23560><span class="icon" data-v-daf23560><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-48a070cb><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-48a070cb><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-71724fcd><div class="item social-links" data-v-71724fcd><div class="VPSocialLinks social-links-list" data-v-71724fcd data-v-1bf78fa1><!--[--><a class="VPSocialLink no-icon" href="https://github.com/kisstar" aria-label="github" target="_blank" rel="noopener" data-v-1bf78fa1 data-v-6efba382><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-5b3ad17e data-v-1a6a9b51><span class="container" data-v-1a6a9b51><span class="top" data-v-1a6a9b51></span><span class="middle" data-v-1a6a9b51></span><span class="bottom" data-v-1a6a9b51></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav fixed reached-top" data-v-eff2d9f0 data-v-4758a42b><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-4758a42b data-v-7a313dc7><button data-v-7a313dc7>Return to top</button><!----></div></div><!----><div class="VPContent" id="VPContent" data-v-eff2d9f0 data-v-34d31248><div class="VPDoc has-aside" data-v-34d31248 data-v-536731fa><!--[--><!--]--><div class="container" data-v-536731fa><div class="aside" data-v-536731fa><div class="aside-curtain" data-v-536731fa></div><div class="aside-container" data-v-536731fa><div class="aside-content" data-v-536731fa><div class="VPDocAside" data-v-536731fa data-v-65d9a64f><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-65d9a64f data-v-323320c0><div class="content" data-v-323320c0><div class="outline-marker" data-v-323320c0></div><div class="outline-title" role="heading" aria-level="2" data-v-323320c0>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-323320c0><span class="visually-hidden" id="doc-outline-aria-label" data-v-323320c0> Table of Contents for current page </span><ul class="root" data-v-323320c0 data-v-5b72f261><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-65d9a64f></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-536731fa><div class="content-container" data-v-536731fa><!--[--><!--]--><!----><main class="main" data-v-536731fa><div style="position:relative;" class="vp-doc _posts_video_2022-03-17-web-video-basic" data-v-536731fa><div><img style="width:100%;height:350px;" src="/images/video/basic/video-boy.jpeg" alt="Video Boy"><p>视频（英语：video, videogram）是泛指将一系列的静态影像以电信号方式加以捕捉、纪录、处理、存储、发送与重现的各种技术。</p><p>视频技术最早是为了电视系统而发展，但现在已经发展为各种不同的格式以利消费者将视频记录下来。网络技术的发达也促使视频的纪录片段以串流媒体的形式存在于因特网之上并可被电脑接收与播放。</p><h2 id="视频的本质" tabindex="-1">视频的本质 <a class="header-anchor" href="#视频的本质" aria-label="Permalink to &quot;视频的本质&quot;">​</a></h2><p>我们常说的视频其实就是一张张图像。根据视觉暂留原理，当连续的图像变化超过每秒 24 张时，人眼无法辨别单幅的静态画面，看上去是平滑连续的视觉效果。</p><p><img src="/images/video/basic/image-queue.png" alt="Image Queue"></p><p>图像则是由一个个像素点组成的，一个分辨率为 m×n 的图像，说明水平方向有 m 个像素点，垂直方向有 n 个像素点。</p><p><img src="/images/video/basic/resolution-ratio.png" alt="Resolution Ratio"></p><p>每个像素点又由三个子像素点组成，当要显示图像时，就会把这幅图像的每一个像素点的 RGB 通道分别对应屏幕上的子像素点绘制到屏幕上，从而显示整个图像。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>对于视频帧的裸数据表示，其实更多的是 YUV 数据格式。</p></div><h2 id="视频存储" tabindex="-1">视频存储 <a class="header-anchor" href="#视频存储" aria-label="Permalink to &quot;视频存储&quot;">​</a></h2><p>视频的存储需要将视频转化为数字的表示形式，既然视频根本是由像素点组成的，那么想要存储一个视频只需要用数字把相应的像素点记录下来就可以了。</p><p>以采用 RGB 颜色模型为例，它将红（Red）、绿（Green）、蓝（Blue）三原色的色光以不同的比例相加，以合成产生各种色彩光。那么，只需要表示出各个颜色的比例就能重现颜色。</p><p><img src="/images/video/basic/rgb.jpeg" alt="RGB"></p><p>数值表示可以使用以下几种不同的方式（以红色为例）：</p><table><thead><tr><th style="text-align:left;">方式</th><th style="text-align:left;">RGB 表示</th></tr></thead><tbody><tr><td style="text-align:left;">浮点</td><td style="text-align:left;">(1.0, 0.0, 0.0)</td></tr><tr><td style="text-align:left;">百分比</td><td style="text-align:left;">(100%, 0%, 0%)</td></tr><tr><td style="text-align:left;">8 比特模式</td><td style="text-align:left;">(255, 0, 0) or sometimes</td></tr><tr><td style="text-align:left;">12 比特模式</td><td style="text-align:left;">(4095, 0, 0)</td></tr><tr><td style="text-align:left;">16 比特模式</td><td style="text-align:left;">(65535, 0, 0)</td></tr><tr><td style="text-align:left;">24 比特模式</td><td style="text-align:left;">(16777215, 0, 0)</td></tr><tr><td style="text-align:left;">32 比特模式</td><td style="text-align:left;">(4294967295, 0, 0)</td></tr></tbody></table><p>当前主流的标准表示方法为 24 比特模式，它使用三个 8 位无符号整数（0 到 255）表示红色、绿色和蓝色的强度。</p><h2 id="视频压缩" tabindex="-1">视频压缩 <a class="header-anchor" href="#视频压缩" aria-label="Permalink to &quot;视频压缩&quot;">​</a></h2><p>存储原始视频通常会占用巨大的空间，例如对一个时长 2 小时、分辨率为 1920x1080P 的视频采用 24 比特模式进行存储的话需要占用：</p><p>$$24<em>1920</em>1080<em>24</em>60<em>60</em>2/8/1024/1024/1024/1024\approx0.98T$$</p><p>可见直接采用这种存储方式是不可行的，更不可能在网络上进行流媒体的流畅播放，所以我们需要通过去除冗余信息来对视频进行编码（压缩）。</p><p>视频编码的推进主要得力于 ITU-T 和 ISO/IEC 两大组织，前者制定的视频编码标准为 H.26x 系列，主要用于基于网络传输的视频通信，后者制定了 MPEG 系列，主要用于视频存储、广播电视、网络流媒体等。</p><p>后续了为了实现标准的一致性，由 ITU-T 和 MPEG 联合制作了 H.262/MPEG-2、H.264/MPEG-4 AVC、H.265/HEVC 等标准。目前 H.264 标准已经在各个领域得到了广泛的应用。</p><p><img src="/images/video/basic/codec.png" alt="Codec"></p><p>由于专利的原因，拥有更高性能的编码标准 H.265 并没有得到普及，为了应对高额的专利费用，开放媒体联盟（Alliance forOpenMedia）开始推行一个开放、免专利的视频编码格式 AOMedia Video 1（简称 AV1）。</p><h2 id="封装格式" tabindex="-1">封装格式 <a class="header-anchor" href="#封装格式" aria-label="Permalink to &quot;封装格式&quot;">​</a></h2><p>除了图像之外，视频文件通常还包括音频和字幕等内容，所以需要通过容器将它们封装到一起，而不同的封装方式也就对应了我们常说的多种视频文件格式。</p><p>容器不同于编解码器，具有相同容器的文件可以使用不同的编解码器来编码其内容，下图说明了这种结构：</p><p><img src="/images/video/basic/mux.png" alt="Mux"></p><p>播放视频时则需要进行反向的解封转、解码操作，最后再将资源交由媒体播放器处理。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>事实上，在 HTML5 视频标准被支持以前，Flash 在 Web 视频播放方面有着统治地位，对应的 FLV 流媒体格式也被广泛应用。</p></div><h2 id="h5-播放" tabindex="-1">H5 播放 <a class="header-anchor" href="#h5-播放" aria-label="Permalink to &quot;H5 播放&quot;">​</a></h2><p>在 HTML5 标准中提供了 <code>&lt;video&gt;</code> 元素用于在 HTML 或者 XHTML 文档中嵌入媒体播放器，用于支持文档内的视频播放。</p><p>使用上，我们可以单独使用 <code>&lt;video&gt;</code> 元素，然后指定 <code>type</code> 属性，以便浏览器将判断是否可以播放提供的视频文件。如果不能，则显示标签中的文本：</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">video</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">src</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;example.webm&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">type</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;video/webm&quot;</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">p</span><span style="color:#E1E4E8;">&gt;Your browser cannot play the provided video file.&lt;/</span><span style="color:#85E89D;">p</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">video</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">video</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">src</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;example.webm&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">type</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;video/webm&quot;</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">p</span><span style="color:#24292E;">&gt;Your browser cannot play the provided video file.&lt;/</span><span style="color:#22863A;">p</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">video</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p>并非所有浏览器都支持最新的容器和编解码器，所以我们需要使用几个不同格式的文件来适配不同的浏览器：</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">video</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">controls</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">source</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">src</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;/example.webm&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">type</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;video/webm&quot;</span><span style="color:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">source</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">src</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;/example.mp4&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">type</span><span style="color:#E1E4E8;">=</span><span style="color:#9ECBFF;">&quot;video/mp4&quot;</span><span style="color:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  &lt;</span><span style="color:#85E89D;">p</span><span style="color:#E1E4E8;">&gt;Your browser cannot play the provided video file.&lt;/</span><span style="color:#85E89D;">p</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;/</span><span style="color:#85E89D;">video</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">video</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">controls</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">source</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">src</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;/example.webm&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">type</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;video/webm&quot;</span><span style="color:#24292E;"> /&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">source</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">src</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;/example.mp4&quot;</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">type</span><span style="color:#24292E;">=</span><span style="color:#032F62;">&quot;video/mp4&quot;</span><span style="color:#24292E;"> /&gt;</span></span>
<span class="line"><span style="color:#24292E;">  &lt;</span><span style="color:#22863A;">p</span><span style="color:#24292E;">&gt;Your browser cannot play the provided video file.&lt;/</span><span style="color:#22863A;">p</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;/</span><span style="color:#22863A;">video</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><p>这里尽管 <code>type</code> 属性对 <code>&lt;source&gt;</code> 标签来说是可选的，但为了确保浏览器仅下载能够播放的文件，应该始终将其添加到标签上。</p><p>实际上，虽然现在大多数网站依然使用 <code>&lt;video&gt;</code> 标签播放视频，但它们并是直接在 <code>src</code> 属性上指定视频源的真实地址，而是使用功能更加强大的 MSE（Media Source Extensions）来实现媒体播放。</p><h2 id="mse" tabindex="-1">MSE <a class="header-anchor" href="#mse" aria-label="Permalink to &quot;MSE&quot;">​</a></h2><p>媒体源扩展 API（MSE） 提供了无插件且基于 Web 的流媒体功能。使用 MSE，媒体串流能够通过 JavaScript 创建，并且能通过使用 <code>&lt;audio&gt;</code> 和 <code>&lt;video&gt;</code> 元素进行播放。</p><p>MSE 使我们可以把通常的单个媒体文件的 <code>src</code> 值替换成引用 MediaSource 对象，以及引用多个 SourceBuffer 对象（代表多个组成整个串流的不同媒体块）的元素。</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> video </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> document.</span><span style="color:#B392F0;">querySelector</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;video&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> mimeCodec </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;video/mp4; codecs=&quot;avc1.42E01E, mp4a.40.2&quot;&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> mediaSource </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MediaSource</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">video.src </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">URL</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">createObjectURL</span><span style="color:#E1E4E8;">(mediaSource);</span></span>
<span class="line"><span style="color:#E1E4E8;">mediaSource.</span><span style="color:#B392F0;">addEventListener</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;sourceopen&#39;</span><span style="color:#E1E4E8;">, sourceOpen);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sourceOpen</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> mediaSource </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">var</span><span style="color:#E1E4E8;"> sourceBuffer </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> mediaSource.</span><span style="color:#B392F0;">addSourceBuffer</span><span style="color:#E1E4E8;">(mimeCodec);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  sourceBuffer.</span><span style="color:#B392F0;">addEventListener</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;updateend&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">function</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    mediaSource.</span><span style="color:#B392F0;">endOfStream</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    video.</span><span style="color:#B392F0;">play</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">  });</span></span>
<span class="line"><span style="color:#E1E4E8;">  sourceBuffer.</span><span style="color:#B392F0;">appendBuffer</span><span style="color:#E1E4E8;">(bufferData </span><span style="color:#6A737D;">/* 获取的 ArrayBuffer 格式的视频数据 */</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">var</span><span style="color:#24292E;"> video </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> document.</span><span style="color:#6F42C1;">querySelector</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;video&#39;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#D73A49;">var</span><span style="color:#24292E;"> mimeCodec </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;video/mp4; codecs=&quot;avc1.42E01E, mp4a.40.2&quot;&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">var</span><span style="color:#24292E;"> mediaSource </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MediaSource</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">video.src </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">URL</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">createObjectURL</span><span style="color:#24292E;">(mediaSource);</span></span>
<span class="line"><span style="color:#24292E;">mediaSource.</span><span style="color:#6F42C1;">addEventListener</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;sourceopen&#39;</span><span style="color:#24292E;">, sourceOpen);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sourceOpen</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> mediaSource </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">var</span><span style="color:#24292E;"> sourceBuffer </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> mediaSource.</span><span style="color:#6F42C1;">addSourceBuffer</span><span style="color:#24292E;">(mimeCodec);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  sourceBuffer.</span><span style="color:#6F42C1;">addEventListener</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;updateend&#39;</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">function</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    mediaSource.</span><span style="color:#6F42C1;">endOfStream</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    video.</span><span style="color:#6F42C1;">play</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">  });</span></span>
<span class="line"><span style="color:#24292E;">  sourceBuffer.</span><span style="color:#6F42C1;">appendBuffer</span><span style="color:#24292E;">(bufferData </span><span style="color:#6A737D;">/* 获取的 ArrayBuffer 格式的视频数据 */</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><p>借助 MSE 我们可以根据内容获取的大小和频率，或是内存占用详情（例如什么时候缓存被回收），进行更加精准地控制。 它是基于它可扩展的 API 建立自适应比特率流客户端（例如 HLS/DASH 的客户端）的基础。</p><h2 id="hls-dash" tabindex="-1">HLS/DASH <a class="header-anchor" href="#hls-dash" aria-label="Permalink to &quot;HLS/DASH&quot;">​</a></h2><p>虽然 MP4 文件在各个浏览器中支持较好，但是由于其头文件较大，初始播放需要下载完整的头文件进行解析，之后再下载一定长度的可播视频片段才能进行播放，这导致初始播放的时间较长。</p><p>HLS 的工作原理就是把整个流分成一个个小的基于 HTTP 的文件来下载，每次只下载一些。当媒体流正在播放时，客户端可以选择从许多不同的备用源中以不同的速率下载同样的资源，允许流媒体会话适应不同的数据速率。</p><p>在开始一个流媒体会话时，客户端会下载一个包含元数据的扩展 M3U (m3u8) 播放列表文件，用于寻找可用的媒体流。然后根据播放列表中的资源地址陆续下载一个个分片资源。</p><p><img src="/images/video/basic/hls.png" alt="HLS"></p><p>HLS 作为苹果推出的流媒体协议，在 IOS 平台上可以获得天然的支持。对于不支持 HLS 的设备也可以使用 HLS.js 库基于 MSE 在浏览器中实现 HLS 播放。</p><p>DASH 是类似于 HLS 的另一种建立在 MSE 的基础之上自适应串流协议，在 DASH 协议中使用 MPD 文件保存有关各种流的信息，它告诉浏览器各种媒体的位置，包括元数据，如 mimeType 和编解码器，以及其他细节。</p><p>整个播放的大体流程也和 HLS 类似，在下载 MPD 文件后，根据解析得到的信息下载后续的音频和视频分片。相比 HLS 而言，DASH 具有最好的跨平台兼容性。</p><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>随着 5G、AR/VR 等技术的发展音视频技术也会随之发展，以带给用户更加友好和沉浸式的体验，同时也会催生更多行业和场景来应用音视频技术。</p><p>本篇主要是围绕视频相关的基础概念以及在 Web 端的播放方式进行了基础的总结，希望能给刚接触 Web 视频的同学带来帮助，欢迎大家一起指正交流。</p><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h2><ul><li><a href="https://zh.wikipedia.org/wiki/%E8%A7%86%E9%A2%91" target="_blank" rel="noreferrer">视频 - 维基百科，自由的百科全书</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/video" target="_blank" rel="noreferrer">&lt;video&gt; - HTML（超文本标记语言） | MDN</a></li><li><a href="https://github.com/video-dev/hls.js" target="_blank" rel="noreferrer">HLS.js - GitHub</a></li><li><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/Audio_and_video_delivery/Setting_up_adaptive_streaming_media_sources" target="_blank" rel="noreferrer">Setting up adaptive streaming media sources - Developer guides | MDN</a></li></ul></div></div></main><footer class="VPDocFooter" data-v-536731fa data-v-9ab9576d><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter" data-v-eff2d9f0 data-v-e8553ae7><div class="container" data-v-e8553ae7><p class="message" data-v-e8553ae7>Developed by Kisstar & Powered by VitePress.</p><p class="copyright" data-v-e8553ae7>Copyright © 2023-present Kisstar</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"computer-graphics_render2screen.md\":\"c02c7cfb\",\"computer-graphics_software.md\":\"98a2fd05\",\"computer-graphics_opengl-pipeline.md\":\"71724dd1\",\"posts_css_2022-04-03-color.md\":\"9bf0d946\",\"effective-cpp_index.md\":\"a6f28693\",\"computer-graphics_index.md\":\"df61981b\",\"posts_audio_2022-01-29-basic-concepts.md\":\"488c7990\",\"posts_audio_2022-02-08-digital-audio.md\":\"edca8cbd\",\"computer-graphics_transformations.md\":\"e848bb6c\",\"posts_chrome_2021-10-23-dev-tools-tech.md\":\"b2448943\",\"effective-cpp_03-use-const.md\":\"006a3656\",\"posts_comprehensive_2021-05-10-parallax-scrolling.md\":\"ef98d0a7\",\"computer-graphics_hardware.md\":\"1d422b86\",\"effective-cpp_02-avoid-define.md\":\"71ddd8b8\",\"categories.md\":\"d1a2ad02\",\"posts_video_2021-09-12-video-basic.md\":\"02ce641e\",\"computer-graphics_coordinate.md\":\"3b93469f\",\"computer-graphics_camera.md\":\"34437eb3\",\"effective-cpp_06-refuse-explicitly.md\":\"f43922d2\",\"posts_electron_2023-04-16-electron-events.md\":\"b5d2538a\",\"effective-cpp_05-default-fun.md\":\"5a1b8a68\",\"posts_video_2021-10-26-videojs-plugin.md\":\"47582a19\",\"posts_video_2021-12-12-videojs-languages.md\":\"bbd98b18\",\"effective-cpp_10-assignment-operator.md\":\"f3ca436a\",\"posts_video_2022-04-28-videojs-logger.md\":\"03acdb42\",\"effective-cpp_11-assignment-self.md\":\"a686a660\",\"posts_react_2020-02-21-react-redux.md\":\"96aa9ff7\",\"tag.md\":\"14b41776\",\"tags.md\":\"cc417bae\",\"posts_nodejs_2021-04-12-koa.md\":\"453730dc\",\"effective-cpp_08-destructor-exception.md\":\"338c0c7d\",\"posts_video_2022-05-08-flv.md\":\"0c85acaf\",\"effective-cpp_09-call-virtual-func.md\":\"c869c65e\",\"computer-graphics_triangle.md\":\"61c57441\",\"posts_vue_2020-02-05-vuex.md\":\"004805b0\",\"posts_video_2022-03-26-videojs-middleware.md\":\"434ffe8f\",\"effective-cpp_01-federation.md\":\"0bdcdab7\",\"effective-cpp_07-virtual-destructor.md\":\"f735050c\",\"index.md\":\"24edd573\",\"effective-cpp_04-init-obj.md\":\"0263adee\",\"posts_vue_2021-09-28-vmodel.md\":\"08694a4c\",\"posts_video_2022-05-29-videojs-tech.md\":\"db046b5d\",\"posts_video_2021-05-31-videojs.md\":\"a58d4f15\",\"effective-cpp_12-copy-object.md\":\"f471f1da\",\"computer-graphics_pipeline.md\":\"be339d71\",\"computer-graphics_texture.md\":\"3ea09c94\",\"posts_vscode_2021-12-18-extensions.md\":\"81e9e842\",\"posts_git_2021-06-14-commitlint.md\":\"01c89740\",\"posts_math_2021-08-03-matrix.md\":\"5afe736c\",\"posts_video_2022-05-05-videojs-modal.md\":\"ae76461f\",\"posts_git_2022-07-31-commitlint-custom.md\":\"91fd01d3\",\"posts_video_2022-03-17-web-video-basic.md\":\"83639c4f\",\"posts_nodejs_2021-05-09-egg.md\":\"a3d749f7\",\"posts_js_2023-05-28-fe-binary.md\":\"4ce6efeb\",\"posts_vue_2023-11-05-vite.md\":\"b6a8c481\",\"posts_react_2019-12-16-redux.md\":\"1f0f67e0\",\"posts_js_2019-12-16-promise.md\":\"dcba65a6\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"Kisstar's 博客\",\"description\":\"Kisstar's 的个人博客站点。\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/kisstar\"}],\"footer\":{\"message\":\"Developed by Kisstar & Powered by VitePress.\",\"copyright\":\"Copyright © 2023-present Kisstar\"}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>